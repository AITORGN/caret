

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <!--
  Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Emerald 
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20120902

-->
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Random Hyperparameter Search</title>
  <link href='http://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>
  <link href="style.css" rel="stylesheet" type="text/css" media="screen" />
  </head>
  <body>
  <div id="wrapper">
  <div id="header-wrapper" class="container">
  <div id="header" class="container">
  <div id="logo">
  <h1><a href="#">Random Hyperparameter Search</a></h1>
</div>

  </div>
  <div><img src="images/img03.png" width="1000" height="40" alt="" /></div>
  </div>
  <!-- end #header -->
<div id="page">
  <div id="content">

      

     
      
<p>
The default method for optimizing tuning parameters in <span class="mx funCall">train</span> is to use a <a href="training.html#grids">grid search</a>. This approach is usually effective but, in cases when there are many tuning parameters, it can be inefficient. An alternative is to use a combination of <a href="adaptive.html">grid search and racing</a>. Another is to use a <a href="http://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf">random selection of tuning parameter combinations</a> to cover the parameter space to a lesser extent. 
</p>
      
<p>
There are a number of models where this can be beneficial in finding reasonable values of the tuning parameters in a relatively short time. However, there are some models where the efficiency in a small search field can cancel out other optimizations. For example, a number of models in caret utilize the "sub-model trick" where <i>M</i> tuning parameter combinations are evaluated, potentially far fewer than M model fits are required. This approach is best leveraged when a simple grid search is used. For this reason, it may be inefficient to use random search for the following model codes: <code>ada</code>, <code>AdaBag</code>, <code>AdaBoost.M1</code>, <code>bagEarth</code>, <code>blackboost</code>, <code>blasso</code>, <code>BstLm</code>, <code>bstSm</code>, <code>bstTree</code>, <code>C5.0</code>, <code>C5.0Cost</code>, <code>cubist</code>, <code>earth</code>, <code>enet</code>, <code>foba</code>, <code>gamboost</code>, <code>gbm</code>, <code>glmboost</code>, <code>glmnet</code>, <code>kernelpls</code>, <code>lars</code>, <code>lars2</code>, <code>lasso</code>, <code>lda2</code>, <code>leapBackward</code>, <code>leapForward</code>, <code>leapSeq</code>, <code>LogitBoost</code>, <code>pam</code>, <code>partDSA</code>, <code>pcr</code>, <code>PenalizedLDA</code>, <code>pls</code>, <code>relaxo</code>, <code>rfRules</code>, <code>rotationForest</code>, <code>rotationForestCp</code>, <code>rpart</code>, <code>rpart2</code>, <code>rpartCost</code>, <code>simpls</code>, <code>spikeslab</code>, <code>superpc</code>, <code>widekernelpls</code>, <code>xgbTree</code>
</p>      
 
<p>
Finally, many of the models wrapped by <span class="mx funCall">train</span> have a small number of parameters. The average number of parameters is <code class="knitr inline">1.7</code>. 
</p>

<p>
To use random search, another option is available in <span class="mx funCall">trainControl</span> called <span class="mx arg">search</span>. Possible values of this argument are <tt><span class="hl str">&quot;grid&quot;</span></tt> and <tt><span class="hl str">&quot;random&quot;</span></tt>. The built-in models contained in caret contain code to generate random tuning parameter combinations. The total number of unique combinations is specified by the <span class="mx arg">tuneLength</span> option to <span class="mx funCall">train</span>.  
</p>

<p>
Again, we will use the sonar data from the previous training page to demonstrate the method with a self-organizing map by looking at a total of 30 tuning parameter combinations:
</p>

    
<div class="chunk" id="random_nnet"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(mlbench)</span>
<span class="hl kwd">data</span><span class="hl std">(Sonar)</span>

<span class="hl kwd">library</span><span class="hl std">(caret)</span>
<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">998</span><span class="hl std">)</span>
<span class="hl std">inTraining</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">createDataPartition</span><span class="hl std">(Sonar</span><span class="hl opt">$</span><span class="hl std">Class,</span> <span class="hl kwc">p</span> <span class="hl std">=</span> <span class="hl num">.75</span><span class="hl std">,</span> <span class="hl kwc">list</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl std">training</span> <span class="hl kwb">&lt;-</span> <span class="hl std">Sonar[ inTraining,]</span>
<span class="hl std">testing</span>  <span class="hl kwb">&lt;-</span> <span class="hl std">Sonar[</span><span class="hl opt">-</span><span class="hl std">inTraining,]</span>

<span class="hl std">fitControl</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">trainControl</span><span class="hl std">(</span><span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">&quot;repeatedcv&quot;</span><span class="hl std">,</span>
                           <span class="hl kwc">number</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">,</span>
                           <span class="hl kwc">repeats</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">,</span>
                           <span class="hl kwc">classProbs</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">,</span>
                           <span class="hl kwc">summaryFunction</span> <span class="hl std">= twoClassSummary,</span>
                           <span class="hl kwc">search</span> <span class="hl std">=</span> <span class="hl str">&quot;random&quot;</span><span class="hl std">)</span>

<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">825</span><span class="hl std">)</span>
<span class="hl std">som_fit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">train</span><span class="hl std">(Class</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">data</span> <span class="hl std">= training,</span>
                  <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">&quot;xyf&quot;</span><span class="hl std">,</span>
                  <span class="hl kwc">preProc</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;center&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;scale&quot;</span><span class="hl std">),</span>
                  <span class="hl kwc">metric</span> <span class="hl std">=</span> <span class="hl str">&quot;ROC&quot;</span><span class="hl std">,</span>
                  <span class="hl kwc">tuneLength</span> <span class="hl std">=</span> <span class="hl num">30</span><span class="hl std">,</span>
                  <span class="hl kwc">trControl</span> <span class="hl std">= fitControl)</span>
<span class="hl std">som_fit</span>
</pre></div>
<div class="output"><pre class="knitr r">Self-Organizing Maps 

157 samples
 60 predictor
  2 classes: 'M', 'R' 

Pre-processing: centered (60), scaled (60) 
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 142, 142, 140, 142, 142, 141, ... 
Resampling results across tuning parameters:

  xdim  ydim  topo         xweight  ROC     Sens    Spec  
   1     2    hexagonal    0.8542   0.6524  0.6496  0.6946
   1     3    hexagonal    0.9402   0.5931  0.6476  0.5461
   1    15    rectangular  0.9759   0.8330  0.7881  0.7050
   1    16    hexagonal    0.6186   0.8703  0.8707  0.8143
   1    17    rectangular  0.6410   0.8498  0.8572  0.8120
   1    22    rectangular  0.6496   0.8760  0.8700  0.8230
   1    24    rectangular  0.5876   0.8676  0.8838  0.8252
   1    24    rectangular  0.8415   0.8588  0.8854  0.8229
   1    25    hexagonal    0.6859   0.8800  0.8862  0.8400
   1    25    rectangular  0.6268   0.8738  0.8974  0.8237
   1    25    rectangular  0.6344   0.8740  0.8865  0.8277
   1    25    rectangular  0.9433   0.8592  0.8453  0.7823
   1    28    hexagonal    0.6921   0.8701  0.8910  0.8195
   1    30    rectangular  0.5288   0.8767  0.8935  0.8311
   2     2    rectangular  0.7122   0.6829  0.6340  0.7096
   2     3    hexagonal    0.5844   0.7337  0.7536  0.7189
   2     3    rectangular  0.8179   0.6987  0.6646  0.7366
   2     8    hexagonal    0.5606   0.8536  0.8689  0.8023
   2     8    rectangular  0.9370   0.8451  0.8606  0.7516
   2    10    rectangular  0.5039   0.8521  0.8792  0.8134
   2    13    rectangular  0.8161   0.8803  0.8907  0.8293
   2    15    rectangular  0.6319   0.8802  0.8986  0.8232
   2    18    hexagonal    0.7623   0.8699  0.8925  0.8059
   2    21    hexagonal    0.8787   0.8688  0.9096  0.8086
   2    21    rectangular  0.5525   0.8972  0.9089  0.8293
   3     3    rectangular  0.9225   0.8013  0.8083  0.6986
   3     4    hexagonal    0.8297   0.8150  0.8313  0.7800
   3     6    hexagonal    0.5846   0.8603  0.8701  0.8155
   3     7    rectangular  0.9813   0.8260  0.8081  0.6907
   3     8    hexagonal    0.9449   0.8735  0.8682  0.7911
   3    11    hexagonal    0.6065   0.8734  0.8899  0.8152
   3    28    hexagonal    0.8075   0.8811  0.9071  0.8064
   4     4    rectangular  0.8349   0.8485  0.8665  0.7993
   4     6    rectangular  0.6527   0.8847  0.8872  0.8314
   4    10    hexagonal    0.6695   0.8811  0.9076  0.8309
   4    10    rectangular  0.5824   0.8874  0.9069  0.8252
   4    11    hexagonal    0.5871   0.8769  0.8894  0.8216
   4    14    rectangular  0.7279   0.8772  0.9029  0.7982
   4    15    hexagonal    0.7570   0.8988  0.9124  0.8123
   4    21    hexagonal    0.5525   0.8844  0.9099  0.8114
   4    22    hexagonal    0.8349   0.8753  0.8935  0.8034
   4    25    rectangular  0.5772   0.8910  0.9135  0.8105
   4    27    rectangular  0.8794   0.8911  0.9072  0.8196
   5     6    rectangular  0.5640   0.8785  0.8985  0.8357
   5    21    rectangular  0.6911   0.8870  0.9000  0.8230
   5    22    rectangular  0.9273   0.9089  0.9153  0.7937
   5    28    hexagonal    0.5633   0.8873  0.8997  0.8261
   6     6    hexagonal    0.8904   0.8770  0.8826  0.8184
   6    12    rectangular  0.8961   0.8931  0.9156  0.8132
   6    16    rectangular  0.5265   0.8831  0.8969  0.8225
   6    18    hexagonal    0.9154   0.8942  0.9079  0.8130
   6    18    rectangular  0.5205   0.8876  0.9039  0.8271
   6    19    rectangular  0.6479   0.8847  0.8942  0.8318
   6    22    hexagonal    0.5849   0.9001  0.9054  0.8393
   6    25    hexagonal    0.7149      NaN     NaN     NaN
   7    16    rectangular  0.7394   0.8847  0.8996  0.8150
   7    16    rectangular  0.8157   0.8861  0.8953  0.8230
   7    17    rectangular  0.8942   0.8910  0.8953  0.8239
   8    11    hexagonal    0.7639   0.8942  0.9096  0.8134
   8    16    hexagonal    0.5506   0.8944  0.9011  0.8334
   8    16    hexagonal    0.6011   0.8998  0.9004  0.8395
   8    19    hexagonal    0.6653      NaN     NaN     NaN
   8    19    hexagonal    0.8309      NaN     NaN     NaN
   8    19    rectangular  0.8213      NaN     NaN     NaN
   9    15    hexagonal    0.6917   0.9053  0.9069  0.8284
   9    17    rectangular  0.8443      NaN     NaN     NaN
  10    14    rectangular  0.6024   0.8829  0.8808  0.8163

ROC was used to select the optimal model using  the largest value.
The final values used for the model were xdim = 5, ydim = 22, xweight = 0.9273 and topo
 = rectangular. 
</pre></div>
</div></div>
    
<p>
There is currently only a <span class="mx funCall">ggplot</span> method (instead of a basic <span class="mx funCall">plot</span> method). The results of this function with random searching depends on the number and type of tuning parameters. In this case, it produces a scatter plot of the three continuous parameters and colors the points based on the topology. The lines are added in the code below. 
</p>
   
<div class="chunk" id="random_plot"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">ggplot</span><span class="hl std">(som_fit)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_smooth</span><span class="hl std">(</span><span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">span</span> <span class="hl std">=</span> <span class="hl num">.8</span><span class="hl std">,</span> <span class="hl kwc">method</span> <span class="hl std">= loess)</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">legend.position</span> <span class="hl std">=</span> <span class="hl str">&quot;top&quot;</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/random_plot-1.png" title="plot of chunk random_plot" alt="plot of chunk random_plot" class="plot" /></div></div>
   
<p>
Otherwise, the <span class="mx funCall">train</span> object works just as any other object from that function.
</p>
   
<div style="clear: both;">&nbsp;</div>
  </div>
  <!-- end #content -->
<div id="sidebar">
<ul>
  <li>
    <h2>General Topics</h2>
    <ul>
      <li><a href="index.html">Front Page</a></li>
      <li><a href="visualizations.html">Visualizations</a></li>
      <li><a href="preprocess.html">Pre-Processing</a><li>
      <li><a href="splitting.html">Data Splitting</a></li>
      <li><a href="varimp.html">Variable Importance</a></li>
      <li><a href="other.html">Model Performance</a></li>
      <li><a href="parallel.html">Parallel Processing</a></li>
    </ul>
    <h2>Model Training and Tuning</h2>
    <ul>
      <li><a href="training.html">Basic Syntax</a></li>
      <li><a href="modelList.html">Sortable Model List</a></li>
      <li><a href="bytag.html">Models By Tag</a></li>
      <li><a href="similarity.html">Models By Similarity</a></li>
      <li><a href="custom_models.html">Using Custom Models</a></li>
      <li><a href="sampling.html">Sampling for Class Imbalances</a></li> 
      <li><a href="random.html">Random Search</a></li> 
      <li><a href="adaptive.html">Adaptive Resampling</a></li> 
    </ul>
    <h2>Feature Selection</h2>
    <ul>
      <li><a href="featureselection.html">Overview</a>
      <li><a href="rfe.html">RFE</a></li>
      <li><a href="filters.html">Filters</a></li>
      <li><a href="GA.html">GA</a></li>
      <li><a href="SA.html">SA</a></li>
    </ul>  
  </li>
</ul>
</div>
<!-- end #sidebar -->
<div style="clear: both;">&nbsp;</div>
  </div>
  <div class="container"><img src="images/img03.png" width="1000" height="40" alt="" /></div>
  <!-- end #page -->
</div>
  <div id="footer-content"></div>
  <div id="footer">
  <p>Created on Sun Apr 10 2016 using caret version 6.0-68 and R Under development (unstable) (2016-04-08 r70447).</p>
  </div>
  <!-- end #footer -->
</body>
  </html>
